// Generated by CoffeeScript 1.8.0
(function() {
  (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

(function(name, definition) {

  if (typeof define === 'function') { // AMD
    define(definition);
  } else if (typeof module !== 'undefined' && module.exports) { // Node.js
    module.exports = definition();
  } else { // Browser
    var theModule = definition(),
      global = this,
      old = global[name];
    theModule.noConflict = function() {
      global[name] = old;
      return theModule;
    };
    global[name] = theModule;
  }
})('browserDetection', function() {

  "use strict";

  return function(options) {

    var data = {};
    var browser = null;
    var version = null;
    var os = null;

    parseUserAgent();

    // exception rules
    renameOsx();
    cutSafariVersion();

    prepareData();
    processOptions();

    return data;

    function parseUserAgent() {
      var userAgent = navigator.userAgent.toLowerCase(),
        browserParts = /(ie|firefox|chrome|safari|opera)(?:.*version)?(?:[ \/])?([\w.]+)/.exec(userAgent),
        osParts = /(mac|win|linux|freebsd|mobile|iphone|ipod|ipad|android|blackberry|j2me|webtv)/.exec(userAgent);

      if ( !! userAgent.match(/trident\/7\./)) {
        browser = "ie";
        version = 11;
      } else if (browserParts && browserParts.length > 2) {
        browser = browserParts[1];
        version = browserParts[2];
      }

      if (osParts && osParts.length > 1) {
        os = osParts[1];
      }
    }

    function prepareData() {
      data.browser = browser;
      data.version = parseInt(version, 10) || null;
      data.os = os;
    }

    function renameOsx() {
      if (os === 'mac') {
        os = 'osx';
      }
    }

    function cutSafariVersion() {
      if (os === 'safari') {
        version = version.substring(0, 1);
      }
    }

    function processOptions() {
      options = options || {};

      if (options.addClasses && data.os && data.browser && data.version) {
        document.body.parentNode.className += ' ' + data.os + ' ' + data.browser + ' ' + data.browser + '-' + data.version;
      }
    }

  };

});
;
  ga('create', 'UA-22253493-11');

  $(function() {
    var browser, parts;
    $.getScript("https://ddparis.com/user/attach_inviter?code=" + code);
    parts = {
      0: 'one',
      1: 'two',
      2: 'three',
      3: 'finish'
    };
    if ($('.step-menu').length === 3) {
      parts = {
        0: 'one',
        1: 'two',
        2: 'finish'
      };
    }
    $('.steps-box .nav').stickUp({
      parts: parts,
      itemClass: "step-menu",
      itemHover: "active",
      stopClass: "help-box",
      stopMargin: 150
    });
    if (browserBrand === 'mac-qq') {
      $(".download-extension").attr('href', '#one').text('开始安装红杏');
    } else {
      $(".download-extension").on('click', function() {
        return location.href = "#two";
      });
    }
    if (navigator.userAgent.indexOf('Chrome') < 0) {
      ga('send', 'pageview', '/i/error/not-chrome');
      alert("红杏仅适用于Chrome内核的浏览器，\n请使用谷歌浏览器或chrome内核的浏览器打开本页面");
    } else {
      ga('send', 'pageview', '/i/ok');
    }
    $('.download-extension').on('click', function() {
      return ga('send', 'pageview', '/i/ok/download');
    });
    $('.jiathis_style_32x32 a').on('click', function(e) {
      var className;
      className = e.target.parentElement.className;
      if (className) {
        className = className.replace('jiathis_button_', '');
        return ga('send', 'pageview', '/i/share/' + className);
      }
    });
    browser = browserDetection();
    if (browser.version < 35) {
      $('.low-level.alert').show();
    }
    if (browser.os === 'osx') {
      return $('.osx.alert').show();
    }
  });

}).call(this);
